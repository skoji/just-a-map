# Just a Map

**just a map** - リアルタイムで更新される以外は単なる地図

バイク（オートバイ）のハンドルマウントで使用することを想定した、シンプルで実用的な地図アプリケーション。

## 主な機能

### 段階1（実装済み）
- ✅ 現在位置を中心とした地図表示
- ✅ 位置情報の自動追従（10m以上移動時）
- ✅ 手動で地図を動かすと追従モード解除
- ✅ 現在地に戻るボタン（60x60ptでグローブ対応）
- ✅ 位置情報権限の適切な処理
- ✅ エラー表示と設定画面への誘導

### 段階2（未実装）
- 現在位置の住所表示
- スリープ防止機能

### 段階3（未実装）
- ズームレベルの調整
- North Up / Heading Up の切り替え
- 地図表示モードの切り替え（標準/航空写真）

## 技術仕様

- **iOS**: 17.0以上
- **フレームワーク**: SwiftUI, MapKit
- **位置情報精度**: 最高精度（kCLLocationAccuracyBest）
- **更新頻度**: 10m移動ごと

## 開発環境

- Xcode 16.0以上
- macOS 14.0以上
- iOS Simulator（iOS 18.5推奨）

## セットアップ

### 1. プロジェクトを開く
```bash
git clone <repository-url>
cd just-a-map
open JustAMap.xcodeproj
```

### 2. ビルドと実行
1. Xcodeでプロジェクトが開いたら、スキームが「JustAMap」になっていることを確認
2. シミュレータデバイスを選択（iPhone 16推奨）
3. ⌘+R でビルド&実行

### 3. 位置情報の権限設定
アプリ起動時に位置情報の許可ダイアログが表示されるので、「Allow While Using App」を選択

## エミュレータで位置情報をシミュレート

### 位置情報の設定方法:
1. エミュレータのメニューバーから: Features > Location
2. 以下のオプションから選択:
   - **Apple**: Apple本社（カリフォルニア）
   - **City Bicycle Ride**: 自転車での移動をシミュレート
   - **City Run**: ランニングでの移動をシミュレート
   - **Freeway Drive**: 高速道路での移動をシミュレート
   - **Custom Location...**: 任意の緯度経度を入力

### おすすめテストシナリオ:
1. まず "Apple" を選択して基本動作を確認
2. "City Bicycle Ride" でバイク走行に近い動きをテスト
3. Custom Location で日本の位置を設定:
   - 東京駅: 緯度 35.6762, 経度 139.6503
   - 大阪駅: 緯度 34.7024, 経度 135.4959

## 5. 動作確認項目

- [ ] アプリ起動時に位置情報許可ダイアログが表示される
- [ ] 許可後、現在地が地図の中心に表示される
- [ ] 位置が移動すると地図も追従する
- [ ] 地図を手動でドラッグすると追従が解除される
- [ ] 右下の位置ボタンをタップすると現在地に戻る
- [ ] 位置情報を拒否した場合、エラーバナーが表示される
- [ ] エラーバナーの「設定」ボタンで設定アプリが開く

## 6. デバッグTips

### 位置情報が取得できない場合:
1. エミュレータをリセット: Device > Erase All Content and Settings...
2. Xcodeをクリーンビルド: Product > Clean Build Folder
3. エミュレータの位置情報設定を確認: Settings > Privacy & Security > Location Services

### コンソールログの確認:
Xcodeの下部にあるデバッグエリアでログを確認できます。

## テスト

### ユニットテストの実行
```bash
xcodebuild test -scheme JustAMapTests -destination 'platform=iOS Simulator,name=iPhone 16'
```

または、Xcode内で ⌘+U

### 現在のテストカバレッジ
- LocationManagerのプロトコル準拠
- 位置情報の権限処理
- 位置情報更新のデリゲート通知
- エラーハンドリング

## トラブルシューティング

### 位置情報が取得できない場合
1. シミュレータの位置情報設定を確認: Features > Location
2. Settings > Privacy & Security > Location Services がオンになっているか確認
3. アプリを削除して再インストール

### "kCLErrorDomain Code=0" エラーが表示される場合
これはシミュレータ特有の一時的なエラーで、アプリの動作には影響しません。実機では発生しません。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 貢献

プルリクエストを歓迎します。大きな変更を行う場合は、まずissueを開いて変更内容について議論してください。